{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "initial_id",
   "metadata": {
    "collapsed": true,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.430766Z",
     "start_time": "2024-03-22T15:12:50.274313300Z"
    }
   },
   "outputs": [],
   "source": [
    "import networkx\n",
    "import networkx as nx\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0 1 1 0]\n",
      " [1 0 1 0]\n",
      " [1 1 0 1]\n",
      " [0 0 1 0]]\n",
      "Graph with 4 nodes and 4 edges\n"
     ]
    }
   ],
   "source": [
    "G = nx.Graph()\n",
    "\n",
    "blue, orange, green = \"#1f77b4\", \"#ff7f0e\",\"#2ca02c\"\n",
    "\n",
    "G.add_nodes_from([(1, {\"color\": blue}),\n",
    "                  (2, {\"color\": orange}),\n",
    "                  (3, {\"color\": blue}),\n",
    "                  (4, {\"color\": green})])\n",
    "G.add_edges_from([(1, 2),(2, 3),(1, 3),(3, 4)])\n",
    "A = np.asarray(nx.adjacency_matrix(G).todense())\n",
    "print(A)\n",
    "print(G)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.512437200Z",
     "start_time": "2024-03-22T15:12:50.427762200Z"
    }
   },
   "id": "5ffca656526d7f4d",
   "execution_count": 2
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "dict_values(['#1f77b4', '#ff7f0e', '#1f77b4', '#2ca02c'])"
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nx.get_node_attributes(G, 'color').values()"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.518989500Z",
     "start_time": "2024-03-22T15:12:50.505102700Z"
    }
   },
   "id": "c5c0e2e9d8b997bc",
   "execution_count": 3
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "\n",
    "def one_hot_on_attribute(G, attribute:str):\n",
    "    \"\"\"\n",
    "    Create a one hot encoding where the mapping dictionary determines the column index of the one hot encoding. \n",
    "    The rows represent each node in the graph. The attribute is the node information that we want to categorise.\n",
    "    \n",
    "    Parameters:\n",
    "    G (nx.Graph or nx.DiGraph): The graph to be processed.\n",
    "    attribute (str): The attribute of the node to be categorised.\n",
    "    \n",
    "    Returns:\n",
    "    np.array: A one hot encoding of the node attributes.\n",
    "    \n",
    "    Example:\n",
    "     G = nx.Graph()\n",
    "     blue, orange, green = \"#1f77b4\", \"#ff7f0e\",\"#2ca02c\"\n",
    "     G.add_nodes_from([(1, {\"color\": blue}),\n",
    "                       (2, {\"color\": orange}),\n",
    "                       (3, {\"color\": blue}),\n",
    "                       (4, {\"color\": green})])\n",
    "     G.add_edges_from([(1, 2),(2, 3),(1, 3),(3, 4)])\n",
    "     one_hot_encoding = one_hot_on_attribute(G, 'color')\n",
    "     print(one_hot_encoding)\n",
    "    [[1. 0. 0.]\n",
    "     [0. 1. 0.]\n",
    "     [1. 0. 0.]\n",
    "     [0. 0. 1.]]\n",
    "    \"\"\"\n",
    "    set_attributes = {v:i for i, v in enumerate(set(nx.get_node_attributes(G, 'color').values()))}\n",
    "    one_hot_idx = np.array([set_attributes[v] for v in nx.get_node_attributes(G, attribute).values()])\n",
    "    one_hot_encoding = np.zeros((one_hot_idx.size, len(set_attributes)))\n",
    "    one_hot_encoding[np.arange(one_hot_idx.size), one_hot_idx] = 1\n",
    "    return one_hot_encoding\n",
    "\n",
    "X = one_hot_on_attribute(G, 'color')"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.554843400Z",
     "start_time": "2024-03-22T15:12:50.522036200Z"
    }
   },
   "id": "8f7273afb01d8349",
   "execution_count": 4
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "array([[0., 1., 0.],\n       [1., 0., 0.],\n       [0., 1., 0.],\n       [0., 0., 1.]])"
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.555843200Z",
     "start_time": "2024-03-22T15:12:50.534943400Z"
    }
   },
   "id": "50d4796697d5b88d",
   "execution_count": 5
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "<Figure size 640x480 with 1 Axes>",
      "image/png": "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8fgMJQC4iZSUFFWqVEkhISH65JNPTMcBvNIHH3yg4cOH69FHH9XChQs5riuLsFACgJvIkyePJk2apE8//VQxMTGm4wBexbIsTZkyRcOGDdPTTz+txYsXUyazEAslALgRh8Oh2rVrq3jx4lq3bh2PZASygNPp1OjRo/XOO+9o0qRJmjBhAn9vZTEWSgBwI35+fpo2bZrWr1+vtWvXmo4DeLz09HT1799f7777rmbPnq2JEydSJrMBCyUAuBnLstSiRQtduHBBO3fulJ/fbT5HGPBxycnJ6t27t9auXaslS5bo4YcfNh3Ja7FQAoCbsdlsmj59uuLj4xUWFmY6DuCRLly4oHbt2mn9+vVatWoVZTKbsVACgJt68MEHFRMTo3379il37tym4wAe4+TJk2rXrp1+//13rV69Wo0bNzYdyeuxUAKAm5oyZYqOHz+uOXPmmI4CeIzDhw8rJCREZ86cUVRUFGUyh7BQAoAbGzZsmD777DMdOnRIhQsXNh0HcGvx8fFq166d8ufPr4iICJUrV850JJ/BQgkAbuzll19Wamqqpk+fbjoK4NY2btyoZs2aqWTJktq4cSNlModRKAHAjZUsWTLz/Lxjx46ZjgO4pdWrV6tt27YKDg7W+vXrddddd5mO5HMolADg5p5//nnlz59fr776qukogNtZunSpunXrprZt22rNmjUqVKiQ6Ug+iUIJAG6uYMGCevnll7Vw4UL9/PPPpuMAbuO9997TY489pscee0xffPEFpyEYxE05AOAB0tLSVLVqVdWoUUNfffWV6TiAUZZl6ZVXXtHkyZP1/PPPa8aMGTz9xjAWSgDwAIGBgZoyZYq+/vprbdy40XQcwBiHw6Hhw4dr8uTJmj59uv71r39RJt0ACyUAeAin06mGDRsqMDBQ0dHR/EsUPictLS3z8va///1vDRw40HQk/BcLJQB4CLvdrunTp2vz5s1auXKl6ThAjkpMTFSXLl20cuVKff7555RJN8NCCQAepl27djpy5Ih2794tf39/03GAbHf27Fl16tRJe/bs0VdffaVWrVqZjoS/YaEEAA8zffp07du3TwsWLDAdBch2x44dU2hoqA4dOqT169dTJt0UCyUAeKC+ffvqP//5jw4cOKB8+fKZjgNki/3796tNmzayLEsRERGqXLmy6Ui4BhZKAPBAr7/+us6ePat33nnHdBQg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66+/Nh0ny+zevVshISGyLEvR0dGUSfg0FkoAQI5o06aNjh8/rvj4ePn7+5uO45JNmzapU6dOKlu2rNauXau77rrLdCTAKBZKAECOmD59uvbu3auPP/7YdBSXfPfdd7r//vtVq1YtRUZGUiYBsVACAHLQo48+qsjISB04cEB58+Y1HeeWhYeHq1+/furQoYM+/fRT5cmTx3QkwC2wUAIAcszrr7+u06dP69133zUd5Za9//776tOnj/r06aMvv/ySMgn8HxRKAECOKV++vIYNG6Zp06bp7NmzpuPcFMuy9Oqrr2rEiBF67rnntGDBAo//DCiQ1SiUAIAcNWHCBFmWpSlTppiOckNOp1MjRozQa6+9pqlTp+rNN9/kudzAVfB3BQAgR91555164YUXNHv2bP3222+m41xTWlqa+vbtq7lz52revHkaO3asV52hCWQlbsoBAOS4pKQkVaxYUffff7+WLFliOs4/JCUl6cEHH9R//vMfhYWFqWfPnqYjAW6NhRIAkOPy5cunV199VcuWLdOuXbtMx7nCuXPn1KZNG23cuFHffvstZRK4CSyUAAAjMjIyVL16dd17771as2aN6TiSpOPHj6tdu3Y6efKkvvvuOzVo0MB0JMAjsFACAIzw9/fX1KlTtXbtWq1bt850HB04cEBNmzbVxYsXtXHjRsokcAtYKAEAxliWpZCQEKWlpWnbtm3G7qCOjY1V+/btVbRoUX3//fcqXbq0kRyAp2KhBAAYY7PZNH36dO3YsUOff/65kQyRkZFq0aKFypYtq6ioKMokcBtYKAEAxnXt2lV79uzR3r17FRgYmGM/9+uvv1bv3r3VtGlTrVixQgUKFMixnw14ExZKAIBxU6dO1W+//aZ///vfOfYzP/74Y/Xo0UOdO3fW6tWrKZOAC1goAQBu4cknn9TXX3+tQ4cOqWDBgtn6s9566y09//zzGjx4sObMmSM/P79s/XmAt2OhBAC4hddee02JiYl68803s+1nWJalcePG6fnnn9dLL72kDz74gDIJZAEWSgCA2xg7dqxmzZqlQ4cOqUSJEln63g6HQ0OHDtX8+fP11ltvadSoUVn6/oAvo1ACANzGhQsXVL58eT300EOaO3dulr1vamqq+vTpo6+++koLFixQv379suy9AVAoAQBu5q233tKLL76on3/+WZUqVZIkJV3O0M8nEvTHhRRlOCzlDfRT5RIFVO6OfLLbbdd9v0uXLql79+7atGmTPvvsM3Xp0iUnfg3Ap1AoAQBuJTU1VZUrV1bdho3V6/kZWrrliPaeTNDV/m2VJ9BPbavdpX6Ny6pumSKy2a4sl6dPn1bHjh21f/9+rVq1Ss2aNcuh3wLwLRRKAIBbsSxLo2Z9puW/2mTPlU82Sdf7F5Wf3SaH01KDckX0Zq/aKntHPknS0aNH1bZtW50/f15r165VcHBwTsQHfBKFEgDgNi6lpuuZT2K1/pfTkuWUbDd/GImf3SZ/u02vd6+hGvkS1bZtW/n7+ysiIkIVK1bMxtQAKJQAALdwKTVdj3y4RXv/SJDDxX8zXd60RMXO79HatWt19913Z01AANdEoQQAGGdZlvov2Kbog2dcLpP/807PKureoELWvBmA6/I3HQAAgE9jfteGA2eu+XVnWooStn6pyyf2Ke3EfjlTE3VHx5HKX/P+q77eJmnSd4fVonppFc6bc88GB3wVT8oBABh1MSVdk775+bqvcaYk6OKmcKWf/V0Bxe+94Xta/33fN7/fl0UpAVwPhRIAYNSXO48pJc1x3df45SuqUk8tUalhC1WkxRM39b4Oy9Ln248pITU9K2ICuA4KJQDAqMWbj9zwNTb/APnlL3LL752W4dRXscdvJxaAW0ChBAAYcz4pTb+eSbruOZOusNukrb+ey6Z3B/A/FEoAgDE/Hb+Yre/vsKTYoxey9WcAoFACAAw6ei4523/GHxdTxAl5QPaiUAIAjMlwOPW3x29nOcvSVZ8DDiDrUCgBAMbkDfTP9rIX4GeT3Z7NrRXwcRRKAIAxQXflz/afUbF49v8MwNdRKAEAxlQtWVDZOR76220KLn3rxw0BuDU8ehEAYEzuAD81qVBMmw+dleMG174TdqyS83KSHIl/HQOUcnCbMi799bjGgvW6yJ4r3z++J8NpqVWV4lkfHMAVKJQAAKP6NymnjQev/Rzv/0nYtkKOhFOZ/3/y/k3S/k2SpPzVW161UN5VIBeFEsgBFEoAgFGtqhRX+Tvz6ciZJDmuM1KWGrbglt97eMuK8uOGHCDb8RlKAIBRfnab3nkoOEufluNnt6lumcJ6rFHZLHxXANdCoQQAGFerVGGNbls5S97LbpPyBfpp5kPBHBcE5BAKJQDALQxvUUFDm1dw6T387Dblz+WvsEGNVPaOf36mEkD2sFk8jwoA4EY+2XZUr67ao3SHJYfz1v4VVatUIb37cB3dW4wyCeQkCiUAwO0cO5+s11fv1fd7Tkr67+MTr/I6P7tNDqelonkDNbxlBT0eci834QAGUCgBAG7rxMUUfb79mLb+elbxxy7qUmqGJMkmqUzRvKpTprDur3aX2lUvoQA/PsUFmEKhBAB4BMuylJzmUIbTUp4APwX6UyABd0GhBAAAgEv44x0AAABcQqEEAACASyiUAAAAcAmFEgAAAC6hUAIAAMAlFEoAAAC4hEIJAAAAl1AoAQAA4BIKJQAAAFxCoQQAAIBLKJQAAABwCYUSAAAALqFQAgAAwCUUSgAAALiEQgkAAACXUCgBAADgEgolAAAAXEKhBAAAgEsolAAAAHAJhRIAAAAuoVACAADAJRRKAAAAuIRCCQAAAJdQKAEAAOASCiUAAABcQqEEAACASyiUAAAAcAmFEgAAAC6hUAIAAMAlFEoAAAC4hEIJAAAAl1AoAQAA4BIKJQAAAFxCoQQAAIBLKJQAAABwCYUSAAAALqFQAgAAwCX/Dz1Ovoa+xDVXAAAAAElFTkSuQmCC"
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "color_map = nx.get_node_attributes(G, 'color').values()\n",
    "nx.draw(G, with_labels=True, node_color=color_map)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.860756600Z",
     "start_time": "2024-03-22T15:12:50.549842100Z"
    }
   },
   "id": "909b6daf111c4eb",
   "execution_count": 6
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Perform the forward pass, computing the convolutions\n",
    "this is what the forward pass looks like"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "81fb321a9b8c5812"
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "array([[1.63628933, 1.51508951, 0.43080575, 1.86729028, 1.78396936,\n        1.4987796 ],\n       [0.78460711, 1.5605979 , 0.75157064, 2.28993653, 1.27843624,\n        1.34898632],\n       [1.7299771 , 2.12787516, 0.46557589, 2.47490721, 2.4376889 ,\n        1.81885299],\n       [0.85451416, 0.94512938, 0.26458349, 1.6827569 , 0.34787869,\n        1.48556385]])"
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f_in, f_out = X.shape[1], 6\n",
    "W_1 = np.random.rand(f_in, f_out)\n",
    "W_2 = np.random.rand(f_in, f_out)\n",
    "h = X @ W_1 + ((A @ X) @ W_2)\n",
    "h"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.921915900Z",
     "start_time": "2024-03-22T15:12:50.863758Z"
    }
   },
   "id": "aa3f2a797476d66d",
   "execution_count": 7
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:50.922918300Z",
     "start_time": "2024-03-22T15:12:50.881140600Z"
    }
   },
   "id": "afecb6d80a012a28",
   "execution_count": 7
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Write the Graph Convolution from Scratch"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "c0b64f1dca0b9acd"
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "import networkx as nx\n",
    "import torch\n",
    "from torch.nn.parameter import Parameter\n",
    "import numpy as np\n",
    "import torch.nn.functional as F\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T15:12:52.125768400Z",
     "start_time": "2024-03-22T15:12:50.892199200Z"
    }
   },
   "id": "d3bc9f496dbfb92f",
   "execution_count": 8
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "class BasicConvolutionLayer(torch.nn.Module):\n",
    "    def __init__(self, number_of_features, encoding_size):\n",
    "        super().__init__()\n",
    "        self.n_features = number_of_features\n",
    "        self.encoding_size = encoding_size\n",
    "        \n",
    "        self.W2 = Parameter(torch.rand((number_of_features, encoding_size), dtype=torch.float32))\n",
    "        self.W1 = Parameter(torch.rand((number_of_features, encoding_size), dtype=torch.float32))\n",
    "        self.bias = Parameter(torch.zeros(encoding_size, dtype=torch.float32))\n",
    "        \n",
    "    def forward(self, X, A):\n",
    "        # Node updates in matrix form XW_1 + AXW_2 + b\n",
    "        # the message term is AXW_2 and the aggregate term is XW_1\n",
    "        #the message term\n",
    "        xw_2 = torch.mm(X, self.W2)\n",
    "        axw_2 = torch.mm(A, xw_2) # use the adjacency matrix to filter the propagated messages\n",
    "        #the aggregate term\n",
    "        axw_1 = torch.mm(X, self.W1)\n",
    "        return axw_1 + axw_2 + self.bias\n",
    " "
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T16:53:49.073035500Z",
     "start_time": "2024-03-22T16:53:49.055956500Z"
    }
   },
   "id": "872820aea4c9d317",
   "execution_count": 24
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X shape: (4, 3)\n",
      "A shape: (4, 4)\n"
     ]
    },
    {
     "data": {
      "text/plain": "torch.Size([4, 8])"
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(f\"X shape: {X.shape}\")\n",
    "print(f\"A shape: {A.shape}\")\n",
    "# here the in channels is the number of columns in X, or the number of features\n",
    "# the out channels is the number of latent features we wish to encode.\n",
    "conv = BasicConvolutionLayer(number_of_features=3, encoding_size=8)\n",
    "\n",
    "M = conv.forward(torch.tensor(X, dtype=torch.float32), torch.tensor(A, dtype=torch.float32))\n",
    "M.shape"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T16:39:07.275858900Z",
     "start_time": "2024-03-22T16:39:07.259836100Z"
    }
   },
   "id": "4ecd281f66d4e9e1",
   "execution_count": 23
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "def global_sum_pool(X, batch_mat):\n",
    "    if batch_mat is None or batch_mat.dim() == 1:\n",
    "        return torch.sum(X, dim=0).unsqueeze(0)\n",
    "    else:\n",
    "        return torch.mm(batch_mat, X)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T16:57:58.687702500Z",
     "start_time": "2024-03-22T16:57:58.669529Z"
    }
   },
   "id": "da51c5192c841f8e",
   "execution_count": 25
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "class NodeNetwork(torch.nn.Module):\n",
    "    def __init__(self, number_of_features):\n",
    "        super().__init__()\n",
    "        self.conv1=BasicConvolutionLayer(number_of_features, 32)\n",
    "        self.conv2 =BasicConvolutionLayer(32, 32)\n",
    "        self.fc_1 = torch.nn.Linear(32,16)\n",
    "        self.out_layer = torch.nn.Linear(16,2)\n",
    "        \n",
    "    def forward(self, A, X, batch_mat):\n",
    "        x = F.relu(self.conv1(X, A)) # perform first convolution\n",
    "        x = F.relu(self.conv2(x, A)) # perform second convolution\n",
    "        output = global_sum_pool(x, batch_mat) # pool the node embeddings\n",
    "        output = self.fc_1(output) #run the pooled embeddings through two fully connected layers\n",
    "        output = self.out_layer(output) #run second fully connected layer\n",
    "        return F.softmax(output, dim=1)\n",
    "        "
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-22T16:59:04.822679100Z",
     "start_time": "2024-03-22T16:59:04.806138100Z"
    }
   },
   "id": "cbef31767eb66871",
   "execution_count": 26
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "start_time": "2024-03-22T15:12:52.518622700Z"
    }
   },
   "id": "d7ceebb91980c62f",
   "execution_count": null
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "start_time": "2024-03-22T15:12:52.519636100Z"
    }
   },
   "id": "ed07b580db870e1f",
   "execution_count": null
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "start_time": "2024-03-22T15:12:52.520636200Z"
    }
   },
   "id": "c27c93a4a7687aaf"
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
