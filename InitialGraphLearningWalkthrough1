{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "initial_id",
   "metadata": {
    "collapsed": true,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:14.922737500Z",
     "start_time": "2024-03-23T07:26:14.459956Z"
    }
   },
   "outputs": [],
   "source": [
    "import networkx\n",
    "import networkx as nx\n",
    "import numpy as np\n"
   ]
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "[[0 1 1 0]\n",
      " [1 0 1 0]\n",
      " [1 1 0 1]\n",
      " [0 0 1 0]]\n",
      "Graph with 4 nodes and 4 edges\n"
     ]
    }
   ],
   "source": [
    "G = nx.Graph()\n",
    "\n",
    "blue, orange, green = \"#1f77b4\", \"#ff7f0e\",\"#2ca02c\"\n",
    "\n",
    "G.add_nodes_from([(1, {\"color\": blue}),\n",
    "                  (2, {\"color\": orange}),\n",
    "                  (3, {\"color\": blue}),\n",
    "                  (4, {\"color\": green})])\n",
    "G.add_edges_from([(1, 2),(2, 3),(1, 3),(3, 4)])\n",
    "A = np.asarray(nx.adjacency_matrix(G).todense())\n",
    "print(A)\n",
    "print(G)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.092288300Z",
     "start_time": "2024-03-23T07:26:14.921737100Z"
    }
   },
   "id": "5ffca656526d7f4d",
   "execution_count": 2
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "dict_values(['#1f77b4', '#ff7f0e', '#1f77b4', '#2ca02c'])"
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nx.get_node_attributes(G, 'color').values()"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.108288900Z",
     "start_time": "2024-03-23T07:26:15.092288300Z"
    }
   },
   "id": "c5c0e2e9d8b997bc",
   "execution_count": 3
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "\n",
    "def one_hot_on_attribute(G, attribute:str):\n",
    "    \"\"\"\n",
    "    Create a one hot encoding where the mapping dictionary determines the column index of the one hot encoding. \n",
    "    The rows represent each node in the graph. The attribute is the node information that we want to categorise.\n",
    "    \n",
    "    Parameters:\n",
    "    G (nx.Graph or nx.DiGraph): The graph to be processed.\n",
    "    attribute (str): The attribute of the node to be categorised.\n",
    "    \n",
    "    Returns:\n",
    "    np.array: A one hot encoding of the node attributes.\n",
    "    \n",
    "    Example:\n",
    "     G = nx.Graph()\n",
    "     blue, orange, green = \"#1f77b4\", \"#ff7f0e\",\"#2ca02c\"\n",
    "     G.add_nodes_from([(1, {\"color\": blue}),\n",
    "                       (2, {\"color\": orange}),\n",
    "                       (3, {\"color\": blue}),\n",
    "                       (4, {\"color\": green})])\n",
    "     G.add_edges_from([(1, 2),(2, 3),(1, 3),(3, 4)])\n",
    "     one_hot_encoding = one_hot_on_attribute(G, 'color')\n",
    "     print(one_hot_encoding)\n",
    "    [[1. 0. 0.]\n",
    "     [0. 1. 0.]\n",
    "     [1. 0. 0.]\n",
    "     [0. 0. 1.]]\n",
    "    \"\"\"\n",
    "    set_attributes = {v:i for i, v in enumerate(set(nx.get_node_attributes(G, 'color').values()))}\n",
    "    one_hot_idx = np.array([set_attributes[v] for v in nx.get_node_attributes(G, attribute).values()])\n",
    "    one_hot_encoding = np.zeros((one_hot_idx.size, len(set_attributes)))\n",
    "    one_hot_encoding[np.arange(one_hot_idx.size), one_hot_idx] = 1\n",
    "    return one_hot_encoding\n",
    "\n",
    "X = one_hot_on_attribute(G, 'color')"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.129288600Z",
     "start_time": "2024-03-23T07:26:15.111288600Z"
    }
   },
   "id": "8f7273afb01d8349",
   "execution_count": 4
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "array([[0., 0., 1.],\n       [1., 0., 0.],\n       [0., 0., 1.],\n       [0., 1., 0.]])"
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.154292600Z",
     "start_time": "2024-03-23T07:26:15.127288900Z"
    }
   },
   "id": "50d4796697d5b88d",
   "execution_count": 5
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "<Figure size 640x480 with 1 Axes>",
      "image/png": "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juJTHn/8cXXu3Fk9e/bU4cOHTccBAOCmcQ6lj8vIyNCtt96q5s2ba8qUKabj+JyzZ88qLCxMt99+u3766SeurgcAeCQmlD5u1qxZOnz4sHr37m06ik8qUqSIJk6cqCVLlmj06NGm4wAAcFOYUPowh8OhevXqqVixYlqyZInpOD6te/fuio2NVXx8vG699VbTcQAAyBEKpQ9bsWKFmjdvrkWLFqlly5am4/i0ixcvqk6dOipdurRWrlwpm81mOhIAANnGkrcPi4qKUlhYmB588EHTUXxegQIFNHnyZK1bt07R0dGm4wAAkCMUSh+1Z88eLViwQL179+ZCEDfRtGlT9e7dWx988IF27dplOg4AANnGkrePeumllzR//nz9+uuvCggIMB0H/5Gamqo777xTQUFB2rBhg/Lly2c6EgAAN8SE0gcdP35csbGx6tGjB2XSzQQGBio2NlY7duzQZ599ZjoOAADZQqH0QV9++aVsNpteeeUV01FwFfXq1VPfvn01YMAAbd261XQcAABuiCVvH5OSkqIKFSqoQ4cOGj58uOk4uIaMjAw1aNBAaWlp2rp1qwIDA01HAgDgmphQ+pjY2FidOnVKERERpqPgOvLly6fY2Fjt379fH374oek4AABcFxNKH2K321WjRg2FhYXpu+++Mx0H2RAZGal33nlHq1atUpMmTUzHAQDgqiiUPmTevHlq06aN1q1bp0aNGpmOg2zIysrSPffco2PHjmnHjh0qUKCA6UgAAFyBQulD7r33XmVkZGjdunWmoyAH9u/frzp16ui5557TyJEjTccBAOAKnEPpIzZv3qxVq1apT58+pqMgh6pWrarIyEiNGjVKixcvNh0HAIArMKH0ER06dNDmzZuVlJTEfaI9kN1uV8uWLbVnzx4lJCSoSJEipiMBAPA3JpQ+4Ndff9WsWbP0xhtvUCY9lNVq1cSJE3XhwgX16tXLdBwAAP4LhdIHDBs2TIUKFdILL7xgOgqcUL58ecXExCg2NlZz5841HQcAgL+x5O3lzp49q/Lly6tnz5769NNPTceBkxwOhx5//HFt2LBBCQkJKlGihOlIAAAwofR248aNU3p6ul5//XXTUeACFotFY8eOVVZWll555RXxeRAA4A4olF4sPT1dw4YN0zPPPKPSpUubjgMXueWWWzR69GjNnj1b06dPNx0HAACWvL3ZV199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roIlbyecO3dO5cuX1+uvv67PPvvMdBzAazkcDj322GPavHmzEhISVLx4cdORAAD/wITSCePGjVNqaqpef/1101EAr2axWDR27FhlZGSoe/fu4nMwALgXCuVNysjI0LBhw/TMM8+oTJkypuMAXq906dIaOXKkZs2apa+//tp0HADAP7DkfZOmTZumZ599VvHx8apVq5bpOIDP6NChgxYvXqyEhAQ+zAGAm6BQ3gSHw6G6deuqRIkS+umnn0zHAXzKqVOnVLNmTdWtW1cLFiyQxWIxHQkAfB5L3jdh+fLl2r59OxuZAwaEhIRo/PjxWrhwoSZOnGg6DgBATChvyiOPPKLDhw9rx44dTEcAQ1588UV988032rlzpypVqmQ6DgD4NAplDu3evVs1a9bU5MmT9dxzz5mOA/is8+fPq1atWqpSpYqWLl0qq5UFFwAwhZ/AOTRkyBCVLl1aHTt2NB0F8GmFChXSpEmTtGLFCg0fPtx0HADwaRTKHPjjjz80depU9ejRQ/7+/qbjAD7vvvvuU48ePfTuu+8qMTHRdBwA8FkseefARx99pCFDhig5OVnFihUzHQeApMuXL+uOO+5QsWLFtGbNGvn5+ZmOBAA+hwllNl2+fFkjR45U165dKZOAGwkODtaUKVO0efNmff7556bjAIBPolBm05QpU3TmzBlFRESYjgLgfzRq1Ehvv/22/v3vf2vHjh2m4wCAz2HJOxuysrJUo0YN1alTR99++63pOACuIi0tTXfddZcsFos2bdqkgIAA05EAwGcwocyG+fPna9++fWxkDrixgIAAxcbGavfu3erfv7/pOADgU5hQZkPTpk1lt9u1du1a01EA3MCAAQP08ccfa926dWrQoIHpOADgEyiUN7Bx40Y1bNhQs2fPVtu2bU3HAXADmZmZaty4sc6dO6ft27crODjYdCQA8Hosed9AVFSUbr31Vj322GOmowDIBj8/P8XGxio5OVnvv/++6TgA4BMolNdx8OBBfffdd3rjjTdks9lMxwGQTdWrV9dnn32mYcOGafny5abjAIDXY8n7OiIiIjR16lQlJycrf/78puMAyAG73a777rtPv/76q+Lj41WoUCHTkQDAazGhvIYzZ85o/Pjx6t69O2US8EBWq1WTJk3SqVOn2KEBAHKZz96j7FJapnYfPa8DJy4qLdMuf5tVlYrnV80yhVQw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DR48WM8995ysVmYjgGn8WwgA8Aj+/v56++23lZiYqAceeEBdu3ZV48aNtWXLFtPRAJ9HoQQAeJSyZctq2rRpWrlypVJSUlS/fn1169ZNJ06cMB0N8FkUSgCAR7rnnnu0detWxcTEaNasWQoNDdWXX36pzMxM09EAn0OhBAB4LD8/P73++utKSkpSu3bt1KNHD9WtW1erV682HQ3wKRRKAIDHK1GihMaNG6eNGzcqMDBQ99xzj5599ln9/vvvpqMBPoFCCQDwGnfddZfWr1+viRMnavHixapWrZoiIyOVnp5uOhrg1dg2CADglc6ePauPP/5YX375papWraqYmBg9+OCDpmMBXokJJQDAKxUpUkTDhg3T9u3bVapUKbVs2VJPPPGEfv31V9PRAK9DoQQAeLVatWpp+fLlmjlzpjZt2qQaNWqoX79+SklJMR0N8BoseQMAfMbFixf16aefKioqSmXLllV0dLTatGkji8ViOhrg0ZhQAgB8RoECBTRw4EAlJCSoevXqatu2rVq1aqXExETT0QCPRqEEAPic0NBQLVy4UN9//72SkpJUq1YtvfPOO7pw4YLpaIBHYskbAODTUlNTFRkZqYEDB6po0aKKjIxUx44dWQYHcoAJJQDApwUGBurDDz/Unj171KhRI3Xq1En33nuv4uPjTUcDPAaFEgAASRUrVtSsWbO0ePFinThxQuHh4erRo4fOnDljOhrg9iiUAAD8wwMPPKAdO3bo888/15QpUxQaGqrx48fLbrebjga4LQolAAD/w9/fX3369FFiYqJatWqlbt26qWHDhtq0aZPpaIBbolACAHANpUuXVmxsrNasWaOMjAw1aNBAL774oo4fP246GuBWKJQAANzA3XffrS1btmjkyJGaM2eOQkNDFRMTo8zMTNPRALdAoQQAIBtsNpu6d++upKQkdejQQREREbrzzju1cuVK09EA4yiUAADkQPHixTV69Ght3rxZ+fPnV7NmzdSxY0cdOXLEdDTAGAolAAA3oW7dulq7dq0mT56sZcuWqXr16ho0aJDS0tJMRwPyHHfKAQDASefOnVO/fv0UExOjKlWqKCYmRg899JDpWECeYUIJAICTChcurCFDhmjHjh0qX768WrVqpTZt2ujAgQOmowF5gkIJAICL1KxZUz///LO++eYbbdu2Tbfffrs++ugjXb582XQ0IFex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"
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "color_map = nx.get_node_attributes(G, 'color').values()\n",
    "nx.draw(G, with_labels=True, node_color=color_map)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.716807Z",
     "start_time": "2024-03-23T07:26:15.140288200Z"
    }
   },
   "id": "909b6daf111c4eb",
   "execution_count": 6
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Perform the forward pass, computing the convolutions\n",
    "this is what the forward pass looks like"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "81fb321a9b8c5812"
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "data": {
      "text/plain": "array([[1.28774233, 0.35751249, 1.7587736 , 2.11333941, 1.37138587,\n        1.50038796],\n       [0.71354578, 1.42253183, 1.69283716, 2.86274961, 0.64237155,\n        0.76190944],\n       [1.86241382, 0.96170351, 2.1400264 , 2.21120305, 2.20542295,\n        2.05919489],\n       [0.56646503, 0.47682824, 0.74647848, 1.84213281, 0.25738799,\n        0.0624106 ]])"
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "f_in, f_out = X.shape[1], 6\n",
    "W_1 = np.random.rand(f_in, f_out)\n",
    "W_2 = np.random.rand(f_in, f_out)\n",
    "h = X @ W_1 + ((A @ X) @ W_2)\n",
    "h"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.733808Z",
     "start_time": "2024-03-23T07:26:15.717807100Z"
    }
   },
   "id": "aa3f2a797476d66d",
   "execution_count": 7
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:15.785318800Z",
     "start_time": "2024-03-23T07:26:15.732806400Z"
    }
   },
   "id": "afecb6d80a012a28",
   "execution_count": 7
  },
  {
   "cell_type": "markdown",
   "source": [
    "# Write the Graph Convolution from Scratch"
   ],
   "metadata": {
    "collapsed": false
   },
   "id": "c0b64f1dca0b9acd"
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "import networkx as nx\n",
    "import torch\n",
    "from torch.nn.parameter import Parameter\n",
    "import numpy as np\n",
    "import torch.nn.functional as F\n"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.008970700Z",
     "start_time": "2024-03-23T07:26:15.749812600Z"
    }
   },
   "id": "d3bc9f496dbfb92f",
   "execution_count": 8
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "class BasicConvolutionLayer(torch.nn.Module):\n",
    "    def __init__(self, number_of_features, encoding_size):\n",
    "        super().__init__()\n",
    "        self.n_features = number_of_features\n",
    "        self.encoding_size = encoding_size\n",
    "        \n",
    "        self.W2 = Parameter(torch.rand((number_of_features, encoding_size), dtype=torch.float32))\n",
    "        self.W1 = Parameter(torch.rand((number_of_features, encoding_size), dtype=torch.float32))\n",
    "        self.bias = Parameter(torch.zeros(encoding_size, dtype=torch.float32))\n",
    "        \n",
    "    def forward(self, X, A):\n",
    "        # Node updates in matrix form XW_1 + AXW_2 + b\n",
    "        # the message term is AXW_2 and the aggregate term is XW_1\n",
    "        #the message term\n",
    "        xw_2 = torch.mm(X, self.W2)\n",
    "        axw_2 = torch.mm(A, xw_2) # use the adjacency matrix to filter the propagated messages\n",
    "        #the aggregate term\n",
    "        axw_1 = torch.mm(X, self.W1)\n",
    "        return axw_1 + axw_2 + self.bias\n",
    " "
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.024972900Z",
     "start_time": "2024-03-23T07:26:21.013970700Z"
    }
   },
   "id": "872820aea4c9d317",
   "execution_count": 9
  },
  {
   "cell_type": "code",
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "X shape: (4, 3)\n",
      "A shape: (4, 4)\n"
     ]
    },
    {
     "data": {
      "text/plain": "torch.Size([4, 8])"
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "print(f\"X shape: {X.shape}\")\n",
    "print(f\"A shape: {A.shape}\")\n",
    "# here the in channels is the number of columns in X, or the number of features\n",
    "# the out channels is the number of latent features we wish to encode.\n",
    "conv = BasicConvolutionLayer(number_of_features=3, encoding_size=8)\n",
    "\n",
    "M = conv.forward(torch.tensor(X, dtype=torch.float32), torch.tensor(A, dtype=torch.float32))\n",
    "M.shape"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.104481200Z",
     "start_time": "2024-03-23T07:26:21.024972900Z"
    }
   },
   "id": "4ecd281f66d4e9e1",
   "execution_count": 10
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "def global_sum_pool(X, batch_mat):\n",
    "    if batch_mat is None or batch_mat.dim() == 1:\n",
    "        return torch.sum(X, dim=0).unsqueeze(0)\n",
    "    else:\n",
    "        return torch.mm(batch_mat, X)"
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.136482600Z",
     "start_time": "2024-03-23T07:26:21.106481800Z"
    }
   },
   "id": "da51c5192c841f8e",
   "execution_count": 11
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "class NodeNetwork(torch.nn.Module):\n",
    "    def __init__(self, number_of_features):\n",
    "        super().__init__()\n",
    "        self.conv1=BasicConvolutionLayer(number_of_features, 32)\n",
    "        self.conv2 =BasicConvolutionLayer(32, 32)\n",
    "        self.fc_1 = torch.nn.Linear(32,16)\n",
    "        self.out_layer = torch.nn.Linear(16,2)\n",
    "        \n",
    "    def forward(self, A, X, batch_mat):\n",
    "        x = F.relu(self.conv1(X, A)) # perform first convolution\n",
    "        x = F.relu(self.conv2(x, A)) # perform second convolution\n",
    "        output = global_sum_pool(x, batch_mat) # pool the node embeddings\n",
    "        output = self.fc_1(output) #run the pooled embeddings through two fully connected layers\n",
    "        output = self.out_layer(output) #run second fully connected layer\n",
    "        return F.softmax(output, dim=1)\n",
    "        "
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.147482Z",
     "start_time": "2024-03-23T07:26:21.124482300Z"
    }
   },
   "id": "cbef31767eb66871",
   "execution_count": 12
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [
    "\n",
    "    "
   ],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.163988400Z",
     "start_time": "2024-03-23T07:26:21.143481900Z"
    }
   },
   "id": "d7ceebb91980c62f",
   "execution_count": 12
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.178991500Z",
     "start_time": "2024-03-23T07:26:21.153485300Z"
    }
   },
   "id": "ed07b580db870e1f",
   "execution_count": 12
  },
  {
   "cell_type": "code",
   "outputs": [],
   "source": [],
   "metadata": {
    "collapsed": false,
    "ExecuteTime": {
     "end_time": "2024-03-23T07:26:21.194992200Z",
     "start_time": "2024-03-23T07:26:21.168991400Z"
    }
   },
   "id": "c27c93a4a7687aaf",
   "execution_count": 12
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 2
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython2",
   "version": "2.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
